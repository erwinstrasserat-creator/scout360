(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[311],{6859:function(e,t,s){Promise.resolve().then(s.bind(s,6624))},6624:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var l=s(7437),a=s(2265),r=s(9376),n=s(5978),d=s(7293),i=s(575),c=s(7648);function o(){let e=(0,r.useParams)().id,{user:t,role:s}=(0,i.a)(),[o,u]=(0,a.useState)([]),[x,m]=(0,a.useState)({}),[h,b]=(0,a.useState)(!0),[f,p]=(0,a.useState)(""),[v,N]=(0,a.useState)(""),[g,y]=(0,a.useState)("YouTube"),[j,I]=(0,a.useState)(null),E=async()=>{b(!0);try{let t=(0,n.query)((0,n.collection)(d.db,"playerVideos"),(0,n.where)("playerId","==",e)),s=(await (0,n.getDocs)(t)).docs.map(e=>({id:e.id,...e.data()}));u(s)}finally{b(!1)}},_=async()=>{if(!t)return;let s=(0,n.query)((0,n.collection)(d.db,"videoFavorites"),(0,n.where)("userId","==",t.uid),(0,n.where)("playerId","==",e)),l=await (0,n.getDocs)(s),a={};l.docs.forEach(e=>{a[e.data().videoId]=e.id}),m(a)};(0,a.useEffect)(()=>{E()},[e]),(0,a.useEffect)(()=>{_()},[e,t]);let w=async s=>{if(s.preventDefault(),f&&v)try{I("Video wird gespeichert..."),await (0,n.addDoc)((0,n.collection)(d.db,"playerVideos"),{playerId:e,title:f,url:v,source:g,createdAt:Date.now(),addedByUid:(null==t?void 0:t.uid)||null}),p(""),N(""),I("Video hinzugef\xfcgt."),await E()}catch(e){console.error(e),I("Fehler beim Speichern.")}},S=async e=>{if(confirm("Video wirklich l\xf6schen?"))try{await (0,n.deleteDoc)((0,n.doc)(d.db,"playerVideos",e)),u(t=>t.filter(t=>t.id!==e))}catch(e){console.error(e),alert("Fehler beim L\xf6schen.")}},P=async e=>{if(!t)return;let s=x[e.id];if(s){await (0,n.deleteDoc)((0,n.doc)(d.db,"videoFavorites",s));let t={...x};delete t[e.id],m(t);return}let l=await (0,n.addDoc)((0,n.collection)(d.db,"videoFavorites"),{userId:t.uid,playerId:e.playerId,videoId:e.id,playerName:"(Spieler)",videoTitle:e.title,videoUrl:e.url,createdAt:Date.now()});m(t=>({...t,[e.id]:l.id}))};return(0,l.jsxs)("main",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h1",{className:"text-xl font-semibold",children:"Videos zu diesem Spieler"}),(0,l.jsx)(c.default,{href:"/players/".concat(e),className:"text-sm text-slate-400 hover:text-slate-200",children:"← Zur\xfcck zum Profil"})]}),(0,l.jsx)("section",{className:"rounded-2xl border border-slate-800 bg-slate-900/60 p-4 text-sm",children:(0,l.jsx)("p",{className:"text-slate-300",children:"Du kannst externe Videos (z.B. YouTube, Wyscout Clips) suchen und die relevanten Links hier abspeichern."})}),"admin"===s&&(0,l.jsxs)("section",{className:"rounded-2xl border border-slate-800 bg-slate-900/60 p-4 space-y-3",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Video hinzuf\xfcgen"}),(0,l.jsxs)("form",{onSubmit:w,className:"grid md:grid-cols-3 gap-3 text-sm",children:[(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("label",{className:"text-xs text-slate-400",children:"Titel"}),(0,l.jsx)("input",{value:f,onChange:e=>p(e.target.value),className:"rounded-lg border border-slate-700 bg-slate-950 px-2 py-1",placeholder:"z.B. Highlights vs. XYZ"})]}),(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("label",{className:"text-xs text-slate-400",children:"Video URL"}),(0,l.jsx)("input",{value:v,onChange:e=>N(e.target.value),className:"rounded-lg border border-slate-700 bg-slate-950 px-2 py-1",placeholder:"https://youtube.com/..."})]}),(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("label",{className:"text-xs text-slate-400",children:"Quelle"}),(0,l.jsx)("input",{value:g,onChange:e=>y(e.target.value),className:"rounded-lg border border-slate-700 bg-slate-950 px-2 py-1",placeholder:"YouTube / Wyscout / ..."})]}),(0,l.jsxs)("div",{className:"md:col-span-3 flex gap-3 items-center mt-2",children:[(0,l.jsx)("button",{type:"submit",className:"rounded-lg bg-emerald-500 px-4 py-2 text-sm font-semibold text-slate-900 hover:bg-emerald-400",children:"Video speichern"}),j&&(0,l.jsx)("span",{className:"text-xs text-slate-400",children:j})]})]})]}),(0,l.jsxs)("section",{className:"rounded-2xl border border-slate-800 bg-slate-900/60 p-4 space-y-3",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Gespeicherte Videos"}),h&&(0,l.jsx)("p",{className:"text-sm text-slate-400",children:"Lade Videos..."}),!h&&0===o.length&&(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"Noch keine Videos gespeichert."}),(0,l.jsx)("div",{className:"space-y-4",children:o.map(e=>{let t=!!x[e.id],a=e.url.includes("youtube.com")||e.url.includes("youtu.be");return(0,l.jsxs)("div",{className:"rounded-xl border border-slate-800 bg-slate-950/60 p-3 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-semibold",children:e.title}),(0,l.jsxs)("p",{className:"text-xs text-slate-400",children:["Quelle: ",e.source||"Unbekannt"]})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{onClick:()=>P(e),className:"text-xs px-3 py-1 rounded-lg border ".concat(t?"border-emerald-400 text-emerald-300":"border-slate-700 text-slate-300"),children:t?"★ Favorit":"☆ Favorit"}),"admin"===s&&(0,l.jsx)("button",{onClick:()=>S(e.id),className:"text-xs px-3 py-1 rounded-lg border border-red-500 text-red-400",children:"L\xf6schen"})]})]}),a?(0,l.jsx)("div",{className:"aspect-video w-full rounded-lg overflow-hidden border border-slate-800 mt-2",children:(0,l.jsx)("iframe",{src:function(e){try{if(e.includes("embed"))return e;if(e.includes("watch?v="))return e.replace("watch?v=","embed/");if(e.includes("youtu.be/")){let t=e.split("youtu.be/")[1].split(/[?&]/)[0];return"https://www.youtube.com/embed/".concat(t)}return e}catch(t){return e}}(e.url),className:"w-full h-full",allowFullScreen:!0})}):(0,l.jsx)("a",{href:e.url,target:"_blank",className:"text-emerald-400 text-xs hover:text-emerald-300",children:"→ Video \xf6ffnen"})]},e.id)})})]})]})}},575:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return c},a:function(){return o}});var l=s(7437),a=s(2265),r=s(7293),n=s(3301),d=s(5978);let i=(0,a.createContext)({user:null,role:null,loading:!0,logout:async()=>{}});function c(e){let{children:t}=e,[s,c]=(0,a.useState)(null),[o,u]=(0,a.useState)(null),[x,m]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=(0,n.Aj)(r.I,async e=>{if(c(e),e){let t=await (0,d.getDoc)((0,d.doc)(r.db,"userRoles",e.uid));u(t.exists()?t.data().role:"none")}else u(null);m(!1)});return()=>e()},[]);let h=async()=>{await (0,n.w7)(r.I)};return(0,l.jsx)(i.Provider,{value:{user:s,role:o,loading:x,logout:h},children:t})}let o=()=>(0,a.useContext)(i)},7293:function(e,t,s){"use strict";s.d(t,{I:function(){return u},db:function(){return o},t:function(){return x}});var l=s(738),a=s(5978),r=s(3301),n=s(62),d=s(257);let i={apiKey:d.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:d.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:d.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:d.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:d.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:d.env.NEXT_PUBLIC_FIREBASE_APP_ID};i.projectId||console.warn("Firebase config not set. Check .env.local");let c=(0,l.C6)().length?(0,l.Mq)():(0,l.ZF)(i),o=(0,a.getFirestore)(c),u=(0,r.v0)(c),x=(0,n.cF)(c)},9376:function(e,t,s){"use strict";var l=s(5475);s.o(l,"useParams")&&s.d(t,{useParams:function(){return l.useParams}}),s.o(l,"useRouter")&&s.d(t,{useRouter:function(){return l.useRouter}}),s.o(l,"useSearchParams")&&s.d(t,{useSearchParams:function(){return l.useSearchParams}})}},function(e){e.O(0,[358,990,933,648,971,117,744],function(){return e(e.s=6859)}),_N_E=e.O()}]);