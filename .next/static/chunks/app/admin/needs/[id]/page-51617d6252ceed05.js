(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[291],{2955:function(e,t,s){Promise.resolve().then(s.bind(s,6219))},6219:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(7437),n=s(2265),r=s(9376),i=s(5978),l=s(7293),o=s(7648);function c(){let e=(0,r.useParams)().id,[t,s]=(0,n.useState)(null),[c,d]=(0,n.useState)([]),[m,u]=(0,n.useState)([]),[x,h]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(async()=>{h(!0);let t=await (0,i.getDoc)((0,i.doc)(l.db,"clubNeeds",e));if(!t.exists()){s(null),h(!1);return}let a={id:t.id,...t.data()};s(a);let n=(await (0,i.getDocs)((0,i.collection)(l.db,"players"))).docs.map(e=>({id:e.id,...e.data()}));u((await (0,i.getDocs)((0,i.query)((0,i.collection)(l.db,"needAssignments"),(0,i.where)("needId","==",e)))).docs.map(e=>({id:e.id,...e.data()})));let r=n.map(e=>({...e,matchScore:function(e,t){var s;let a=0,n=100,r=null!==(s=t.tolerance)&&void 0!==s?s:0;if(e.position&&t.position&&(e.position.toLowerCase()===t.position.toLowerCase()?a+=25:(e.position.toLowerCase().includes(t.position.toLowerCase())||t.position.toLowerCase().includes(e.position.toLowerCase()))&&(a+=17.5)),t.minAge||t.maxAge){let s=0;t.minAge&&e.age>=t.minAge&&(s+=.5),t.maxAge&&e.age<=t.maxAge&&(s+=.5),a+=20*s}if(t.heightMin&&e.heightCm&&(e.heightCm>=t.heightMin?a+=10:e.heightCm>=t.heightMin-3&&(a+=5)),t.requiredTraits&&t.requiredTraits.length>0){let s=(e.strengths||[]).map(e=>e.toLowerCase()),n=0;for(let e of t.requiredTraits){let t=e.toLowerCase();s.some(e=>e.includes(t))&&n++}a+=10*Math.min(1,n/t.requiredTraits.length)}if(t.minStats){let s=0,n=0;for(let a of Object.keys(t.minStats)){let i=t.minStats[a];if(null==i)continue;n++;let l=e.stats[a],o=i-r;l>=i?s+=1:l>=o&&(s+=.5)}n>0&&(a+=s/n*35)}return t.preferredFoot&&e.foot===t.preferredFoot&&(a+=5,n+=5),Math.min(100,a/n*100)}(e,a)}));r.sort((e,t)=>t.matchScore-e.matchScore),d(r),h(!1)})()},[e]);let f=(0,n.useMemo)(()=>new Set(m.map(e=>e.playerId)),[m]);return x?(0,a.jsx)("main",{className:"p-6 text-sm text-slate-400",children:"Bedarfsliste & Spieler werden geladen..."}):t?(0,a.jsxs)("main",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h1",{className:"text-xl font-semibold",children:[t.clubName," – ",t.position]}),(0,a.jsx)(o.default,{href:"/admin/needs",className:"text-sm text-slate-400 hover:text-slate-200",children:"← Zur\xfcck zur \xdcbersicht"})]}),(0,a.jsxs)("section",{className:"rounded-2xl border border-slate-800 bg-slate-900/60 p-6 text-sm",children:[(0,a.jsxs)("p",{className:"text-slate-300",children:["Alter: ",t.minAge||"?","–",t.maxAge||"?"," • Min. Gr\xf6\xdfe:"," ",t.heightMin||"?"," cm • Toleranz: ",t.tolerance,"%"]}),(0,a.jsxs)("p",{className:"text-slate-300 mt-1",children:["Bevorzugter Fu\xdf: ",t.preferredFoot||"egal"]}),(0,a.jsxs)("p",{className:"text-slate-300 mt-1",children:["Gesuchte Merkmale:"," ",t.requiredTraits.length?t.requiredTraits.join(", "):"keine expliziten Merkmale"]}),t.notes&&(0,a.jsxs)("p",{className:"text-slate-400 mt-2",children:["Notizen: ",t.notes]})]}),(0,a.jsxs)("section",{className:"rounded-2xl border border-slate-800 bg-slate-900/60 p-6 space-y-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Spieler-Matches"}),(0,a.jsx)("p",{className:"text-xs text-slate-400 mb-2",children:"Spieler sind nach Match-Score sortiert. Gr\xfcn = alle Bedingungen weitgehend erf\xfcllt."}),(0,a.jsx)("div",{className:"space-y-3",children:c.map(t=>(0,a.jsxs)("div",{className:"rounded-xl border border-slate-800 bg-slate-950/60 p-3 text-sm flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-semibold text-slate-100",children:[t.name," (",t.age,") – ",t.position]}),(0,a.jsxs)("p",{className:"text-xs text-slate-400",children:[t.club," • ",t.league," • ",t.nationality]}),(0,a.jsxs)("p",{className:"text-xs text-slate-400 mt-1",children:["Technik ",t.stats.technik,", Tempo ",t.stats.tempo,", Physis"," ",t.stats.physis,", Intelligenz ",t.stats.intelligenz,", Defensiv"," ",t.stats.defensiv,", Offensiv ",t.stats.offensiv]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-lg font-semibold ".concat(t.matchScore>=80?"text-emerald-400":t.matchScore>=60?"text-yellow-400":"text-slate-300"),children:[Math.round(t.matchScore),"%"]}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"Match Score"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(o.default,{href:"/players/".concat(t.id),className:"text-xs px-3 py-1 rounded-lg border border-slate-700 text-slate-200 hover:border-emerald-400",children:"Profil"}),(0,a.jsx)(o.default,{href:"/admin/assign-player/".concat(t.id,"?needId=").concat(e),className:"text-xs px-3 py-1 rounded-lg bg-emerald-500 text-slate-900 font-semibold hover:bg-emerald-400",children:"Zuordnen"})]}),f.has(t.id)&&(0,a.jsx)("p",{className:"text-[10px] text-emerald-400",children:"Bereits zugeordnet"})]})]},t.id))})]})]}):(0,a.jsx)("main",{className:"p-6 text-sm text-red-400",children:"Bedarfsliste nicht gefunden."})}},7293:function(e,t,s){"use strict";s.d(t,{I:function(){return m},db:function(){return d},t:function(){return u}});var a=s(738),n=s(5978),r=s(3301),i=s(62),l=s(257);let o={apiKey:l.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:l.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:l.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:l.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:l.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:l.env.NEXT_PUBLIC_FIREBASE_APP_ID};o.projectId||console.warn("Firebase config not set. Check .env.local");let c=(0,a.C6)().length?(0,a.Mq)():(0,a.ZF)(o),d=(0,n.getFirestore)(c),m=(0,r.v0)(c),u=(0,i.cF)(c)},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[358,990,933,648,971,117,744],function(){return e(e.s=2955)}),_N_E=e.O()}]);