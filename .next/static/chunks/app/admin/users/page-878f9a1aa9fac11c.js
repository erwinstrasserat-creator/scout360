(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[674],{2362:function(e,t,s){Promise.resolve().then(s.bind(s,7525))},7525:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var n=s(7437),r=s(2265),l=s(7648),a=s(5978),d=s(7293);function c(){let[e,t]=(0,r.useState)([]),[s,c]=(0,r.useState)(!0),[i,o]=(0,r.useState)(null),[x,u]=(0,r.useState)(null),h=async()=>{try{u(null),c(!0);let e=(await (0,a.getDocs)((0,a.collection)(d.db,"userRoles"))).docs.map(e=>({id:e.id,...e.data()}));t(e)}catch(e){console.error(e),u("Fehler beim Laden der Benutzer.")}finally{c(!1)}};(0,r.useEffect)(()=>{h()},[]);let m=async(e,s)=>{o(e);try{await (0,a.updateDoc)((0,a.doc)(d.db,"userRoles",e),{role:s}),t(t=>t.map(t=>t.id===e?{...t,role:s}:t))}catch(e){console.error(e),u("Fehler beim Speichern der Rolle.")}finally{o(null)}},p=async e=>{if(confirm("Benutzer wirklich entfernen? (Nur Firestore-Zuordnung, nicht Firebase Auth)"))try{await (0,a.deleteDoc)((0,a.doc)(d.db,"userRoles",e)),t(t=>t.filter(t=>t.id!==e))}catch(e){console.error(e),u("Fehler beim Entfernen.")}};return(0,n.jsxs)("main",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("h1",{className:"text-xl font-semibold",children:"Benutzerverwaltung"}),(0,n.jsx)(l.default,{href:"/admin/users/new",className:"rounded-lg bg-emerald-500 px-4 py-2 text-sm font-semibold text-slate-950 hover:bg-emerald-400",children:"+ Neuen Benutzer einladen"})]}),s&&(0,n.jsx)("p",{className:"text-sm text-slate-400",children:"Lade Benutzer..."}),x&&(0,n.jsx)("p",{className:"text-sm text-red-400",children:x}),(0,n.jsx)("div",{className:"rounded-2xl border border-slate-800 bg-slate-900/60 overflow-hidden",children:(0,n.jsxs)("table",{className:"w-full text-sm",children:[(0,n.jsx)("thead",{className:"text-xs text-slate-400 border-b border-slate-800",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-3 py-2 text-left",children:"UID"}),(0,n.jsx)("th",{className:"px-3 py-2 text-left",children:"E-Mail (optional)"}),(0,n.jsx)("th",{className:"px-3 py-2 text-left",children:"Rolle"}),(0,n.jsx)("th",{className:"px-3 py-2 text-right",children:"Aktionen"})]})}),(0,n.jsxs)("tbody",{children:[e.map(e=>{var t;return(0,n.jsxs)("tr",{className:"border-b border-slate-800/60",children:[(0,n.jsx)("td",{className:"px-3 py-2 font-mono text-xs",children:e.id}),(0,n.jsx)("td",{className:"px-3 py-2",children:null!==(t=e.email)&&void 0!==t?t:"â€”"}),(0,n.jsx)("td",{className:"px-3 py-2",children:(0,n.jsxs)("select",{value:e.role,disabled:i===e.id,onChange:t=>m(e.id,t.target.value),className:"rounded-lg border border-slate-700 bg-slate-950 px-2 py-1 text-xs",children:[(0,n.jsx)("option",{value:"admin",children:"admin"}),(0,n.jsx)("option",{value:"reader",children:"reader"})]})}),(0,n.jsx)("td",{className:"px-3 py-2 text-right",children:(0,n.jsx)("button",{onClick:()=>p(e.id),className:"text-xs text-red-400 hover:text-red-300",children:"Entfernen"})})]},e.id)}),!s&&0===e.length&&(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:4,className:"px-3 py-6 text-center text-slate-400 text-xs",children:"Keine Nutzer vorhanden."})})]})]})})]})}},7293:function(e,t,s){"use strict";s.d(t,{I:function(){return x},db:function(){return o},t:function(){return u}});var n=s(738),r=s(5978),l=s(3301),a=s(62),d=s(257);let c={apiKey:d.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:d.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:d.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:d.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:d.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:d.env.NEXT_PUBLIC_FIREBASE_APP_ID};c.projectId||console.warn("Firebase config not set. Check .env.local");let i=(0,n.C6)().length?(0,n.Mq)():(0,n.ZF)(c),o=(0,r.getFirestore)(i),x=(0,l.v0)(i),u=(0,a.cF)(i)}},function(e){e.O(0,[358,990,933,648,971,117,744],function(){return e(e.s=2362)}),_N_E=e.O()}]);